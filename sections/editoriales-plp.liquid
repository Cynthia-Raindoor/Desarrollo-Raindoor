{% comment %}
  Editoriales Section for Dawn Theme - SIMPLIFICADO
  Mobile: 2 columnas | Desktop: 4 columnas
{% endcomment %}

{%- liquid
  assign skip_container = section.settings.skip_container
  assign container_class = 'page-width'
  if skip_container
    assign container_class = ''
  endif
-%}

<section class="section-gallery-{{ section.id }}">
  <div class="{{ container_class }}">
    <div class="gallery-grid">
      {% for block in section.blocks %}
        {%- liquid
          assign image = block.settings.image
          assign page = block.settings.page_selected
          assign texto = block.settings.texto
        -%}

        <div class="gallery-item" {{ block.shopify_attributes }}>
          {% if page != blank %}
            <a href="{{ page.url }}">
          {% endif %}

          {% if image != blank %}
            <img
              src="{{ image | image_url: width: 800 }}"
              alt="{{ image.alt | escape }}"
              loading="lazy"
              width="100%"
              height="auto"
              class="img-normal"
            >
          {% else %}
            {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
          {% endif %}

          {% if texto %}
            <span class="txt_card">
              {{ texto | escape }}
            </span>
          {% endif %}
          {% if page != blank %}
            </a>
          {% endif %}
        </div>
      {% endfor %}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Listado de Editoriales",
  "class": "section-gallery",
  "max_blocks": 50,
  "settings": [
    {
      "type": "number",
      "id": "margin_top",
      "default": 50,
      "label": "Margen Superior (px)"
    },
    {
      "type": "number",
      "id": "margin_bottom",
      "default": 50,
      "label": "Margen Inferior (px)"
    },
    {
      "type": "checkbox",
      "id": "skip_container",
      "label": "Ancho completo (Full width)",
      "default": false
    },
    {
      "type": "range",
      "id": "grid_gap",
      "min": 0,
      "max": 30,
      "step": 1,
      "unit": "px",
      "label": "Espacio entre imágenes",
      "default": 10
    },
    {
      "type": "range",
      "id": "columnas",
      "default": 3,
      "min":2,
      "max":4,
      "label": "Cantidad de columnas"
    }
  ],
  "blocks": [
    {
      "type": "column",
      "name": "Editorial",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Imagen"
        },
        {
          "type": "page",
          "id": "page_selected",
          "label": "Página destino"
        },
        {
          "type": "text",
          "id": "texto",
          "label": "Texto"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Listado de Editoriales",
      "blocks": [{ "type": "column" }, { "type": "column" }, { "type": "column" }, { "type": "column" }]
    }
  ]
}
{% endschema %}

{% style %}
    .section-gallery-{{ section.id }} .gallery-item {
      position:relative;
    }
    .section-gallery-{{ section.id }} span.txt_card {
        position: absolute;
        z-index:3;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-weight: 700;
        color: white;
        text-transform: uppercase;
    }

      .section-gallery-{{ section.id }} {
        padding-top: {{ section.settings.margin_top }}px;
        padding-bottom: {{ section.settings.margin_bottom }}px;
      }

      /* === GRID MAGICO === */
      .section-gallery-{{ section.id }} .gallery-grid {
        display: grid;
        /* Mobile: 2 columnas */
        grid-template-columns: repeat(2, 1fr);
        gap: {{ section.settings.grid_gap }}px;
      }

      /* Desktop (desde 750px para arriba): 4 columnas */
      @media screen and (min-width: 750px) {
        .section-gallery-{{ section.id }} .gallery-grid {
          grid-template-columns: repeat({{ section.settings.columnas}}, 1fr);
        }
      }


      /* === ESTILOS IMAGEN === */
      .section-gallery-{{ section.id }} .gallery-item img {
        width: 100%;
        height: auto;
        display: block;
        object-fit: cover;
        aspect-ratio: auto; 
      }

      .section-gallery-{{ section.id }} a {
        display: block;
        text-decoration: none;
        transition: opacity 0.3s ease;
      }
.gallery-item a {
  position: relative;
  display: block;
}

.gallery-item a::after {
  content: "";
  background: rgba(0, 0, 0, 0.2);
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  opacity: 0;
  transition: opacity 300ms;
  pointer-events: none; 
}

.gallery-item a:hover::after {
  opacity: 1;
}

      /* Placeholder por si no suben foto */
      .section-gallery-{{ section.id }} .placeholder-svg {
        width: 100%;
        height: auto;
        background: #f0f0f0;
      }
{% endstyle %}
